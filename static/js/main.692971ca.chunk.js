(this["webpackJsonplist-of-houses"]=this["webpackJsonplist-of-houses"]||[]).push([[0],{37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(19),r=a.n(s),o=a(7),l=a(8),i=a(2),h=a(20),u=a(21),j=new(function(){function e(t){var a=t.url,n=t.login,c=t.user,s=t.updateHouses;Object(h.a)(this,e),this.url=a,this.user=c,this.updateHouses=s,this.login=n,this.token=localStorage.getItem("token")||"",this.status=[200,400,401,409],this.getResponse=this.getResponse.bind(this)}return Object(u.a)(e,[{key:"getResponse",value:function(e){return this.status.includes(e.status)?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430 api: ".concat(e.status)))}},{key:"authorizationPost",value:function(e){var t=e.password,a=e.email;return fetch("".concat(this.url).concat(this.login),{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({password:t,username:a})}).then(this.getResponse)}},{key:"getInfoForUser",value:function(e){return fetch("".concat(this.url).concat(this.user),{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(e)}}).then(this.getResponse)}},{key:"getInfoUpdateUser",value:function(e){var t=e.company_id,a=e.page,n=e.perPage;return fetch("".concat(this.url).concat(this.updateHouses).concat(t,"/?page=").concat(a,"&perPage=").concat(n),{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(this.token)}}).then(this.getResponse)}}]),e}())({url:"http://test-alpha.reestrdoma.ru/api/",user:"reestrdoma/companies/",login:"login/",updateHouses:"reestrdoma/company/houses/"}),d=a(13),b=a(16),m=a(0),p=function(e){var t=e.loginHandler,a=Object(i.f)(),n=c.a.useState({email:localStorage.getItem("email")||"",password:""}),s=Object(l.a)(n,2),r=s[0],o=s[1],h=function(e){o(Object(b.a)(Object(b.a)({},r),{},Object(d.a)({},e.target.name,e.target.value)))};return Object(m.jsxs)("section",{className:"login",children:[Object(m.jsx)("h2",{children:"Login"}),Object(m.jsx)("input",{placeholder:"\u043b\u043e\u0433\u0438\u043d",name:"email",defaultValue:r.email,type:"text",onChange:h}),Object(m.jsx)("input",{placeholder:"\u043f\u0430\u0440\u043e\u043b\u044c",name:"password",defaultValue:r.password,type:"password",onChange:h}),Object(m.jsx)("button",{type:"submit",title:"\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",onClick:function(e){e.preventDefault(),t(r).then((function(){return a.push("/")}))},children:"\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})},g=a.p+"static/media/logo.6ce24c58.svg",O=function(){return Object(m.jsxs)("nav",{className:"nav-bar",children:[Object(m.jsx)("img",{className:"logo",src:g,alt:"logo"}),Object(m.jsxs)("ul",{className:"nav-bar__links",children:[Object(m.jsx)("li",{className:"nav-bar__link",children:Object(m.jsx)(o.b,{className:"nav-bar__link",to:"/",exact:!0,activeClassName:"nav-bar__link_active",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430"})}),Object(m.jsx)("li",{className:"nav-bar__link",children:Object(m.jsx)(o.b,{className:"nav-bar__link",to:"/login",exact:!0,activeClassName:"nav-bar__link_active",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"})})]})]})},f=function(){var e=Object(i.f)();return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h2",{children:"404"}),Object(m.jsx)("button",{type:"button",onClick:function(){return e.push("/")},children:"\u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"})]})},x=a(23);var _=function(e){var t=new Date(e.replace(/th|nd|st/,"")),a=t.getFullYear().toString(),n=(t.getMonth()+1).toString(),c=t.getDate().toString();return n.length<2&&(n="0".concat(n)),c.length<2&&(c="0".concat(c)),[c,n,a].join(".")},v=function(e){var t=e.data,a=c.a.useState([]),n=Object(l.a)(a,2),s=n[0],r=n[1],o=c.a.useState([{id:"",address:"",reestrFlatCount:"",createdAt:new Date}]),i=Object(l.a)(o,2),h=i[0],u=i[1];return c.a.useEffect((function(){r([{id:0,name:""}].concat(Object(x.a)(t)))}),[t]),Object(m.jsxs)("section",{className:"table-info",children:[Object(m.jsx)("h2",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044e:"}),Object(m.jsx)("select",{className:"table-select",onChange:function(e){if(e.target.value){var a=t.find((function(t){return t.name===e.target.value})),n=t.indexOf(a);j.getInfoUpdateUser({company_id:a.id,page:n,perPage:t.length}).then((function(e){return u(e.data)})).catch((function(e){return console.error(e)}))}else u([{id:"",address:"",reestrFlatCount:"",createdAt:new Date}])},children:s.map((function(e){return Object(m.jsx)("option",{children:e.name},e.id)}))}),Object(m.jsx)("table",{className:"table",children:Object(m.jsxs)("tbody",{children:[Object(m.jsxs)("tr",{className:"table__col table__coll_theme_yellow",children:[Object(m.jsx)("th",{className:"table__cell",children:"id"}),Object(m.jsx)("th",{className:"table__cell",children:"\u0410\u0434\u0440\u0435\u0441"}),Object(m.jsx)("th",{className:"table__cell",children:"\u041d\u043e\u043c\u0435\u0440 \u0432 \u0440\u0435\u0435\u0441\u0442\u0440\u0435"}),Object(m.jsx)("th",{className:"table__cell",children:"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f"})]}),h.map((function(e){return Object(m.jsxs)("tr",{className:"table__col",children:[Object(m.jsx)("th",{className:"table__cell",children:e.id}),Object(m.jsx)("th",{className:"table__cell",children:e.address}),Object(m.jsx)("th",{className:"table__cell",children:e.reestrFlatCount}),Object(m.jsx)("th",{className:"table__cell",children:_(e.createdAt.toString())})]},e.id)}))]})})]})},N=function(){var e=c.a.useState(""),t=Object(l.a)(e,2),a=t[0],n=t[1],s=c.a.useState([]),r=Object(l.a)(s,2),o=r[0],h=r[1];return c.a.useEffect((function(){localStorage.getItem("token")&&j.getInfoForUser(localStorage.getItem("token")).then((function(e){h(e.data)})).catch((function(e){return console.error("\u043e\u0448\u0438\u0431\u043a\u0430 \u0430\u043f\u0438 ".concat(e))}))}),[]),Object(m.jsxs)("div",{className:"page",children:[Object(m.jsx)("header",{className:"header",children:Object(m.jsx)(O,{})}),Object(m.jsx)("main",{className:"content",children:Object(m.jsxs)(i.c,{children:[Object(m.jsxs)(i.a,{exact:!0,path:"/",children:[Object(m.jsx)("h1",{children:a||"\u0421\u043f\u0438\u0441\u043e\u043a"}),Object(m.jsx)(v,{data:o})]}),Object(m.jsx)(i.a,{exact:!0,path:"/login",children:Object(m.jsx)(p,{loginHandler:function(e){return j.authorizationPost(e).then((function(t){var a=t.data,c=a.token;return localStorage.setItem("token",c.access),localStorage.setItem("email",e.email),n("\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c! ".concat(a.firstName||"\u0413\u043e\u0441\u0442\u044c")),Promise.resolve()})).catch((function(e){return console.error(e.message||"\u043e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438")}))}})}),Object(m.jsx)(i.a,{path:"*",component:f})]})})]})};a(37);r.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(o.a,{children:Object(m.jsx)(N,{})})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.692971ca.chunk.js.map